{% extends 'base.html.twig' %}

{% block stylesheets %}
    <link rel='stylesheet' type="text/css" href='https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css'>
{% endblock %}

{% block javascripts %}
            <script type='text/javascript' src="https://code.jquery.com/jquery-3.5.1.js"></script>
            <script type='text/javascript' src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
            <script type='text/javascript'>
                $(document).ready(function() {
                $('#example').DataTable({language: {
                    processing:     "Traitement en cours...",
                    search:         "Rechercher&nbsp;:",
                    lengthMenu:    "Afficher _MENU_ &eacute;l&eacute;ments",
                    info:           "Affichage de l'&eacute;lement _START_ &agrave; _END_ sur _TOTAL_ &eacute;l&eacute;ments",
                    infoEmpty:      "Affichage de l'&eacute;lement 0 &agrave; 0 sur 0 &eacute;l&eacute;ments",
                    infoFiltered:   "(filtr&eacute; de _MAX_ &eacute;l&eacute;ments au total)",
                    infoPostFix:    "",
                    loadingRecords: "Chargement en cours...",
                    zeroRecords:    "Aucun &eacute;l&eacute;ment &agrave; afficher",
                    emptyTable:     "Aucune donnée disponible dans le tableau",
                    paginate: {
                        first:      "Premier",
                        previous:   "Pr&eacute;c&eacute;dent",
                        next:       "Suivant",
                        last:       "Dernier"
                    },
                    aria: {
                        sortAscending:  ": activer pour trier la colonne par ordre croissant",
                        sortDescending: ": activer pour trier la colonne par ordre décroissant"
                    }
                    }});
                } );
            </script>
{% endblock %}

{% block title %}Catalogue{% endblock %}

{% block body %}
<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

<main class='container-fluid mb-5'>
    <h1 class='text-center text-decoration-underline my-5'>Catalogue <i class="fas fa-book"></i></h1>

    <div class='row'>
        <div class='col-12 col-lg-3 px-5'>
            <a class="btn btn-info my-5" href="{{ path('book_add') }}">Ajouter un livre</a>
            {{form(formFilter)}}
        </div>
        <div class='col-12 col-lg-9'>
            <table id='example' class='display'>
                <thead>
                    <tr>
                        <th></th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for book in books %}
                    <tr>
                        <td style="max-width: 450px">
                            <h5 class='pb-2 border-bottom'>{{ book.getTitle() }}, {{ book.getWriterid().getFirstname() }} {{ book.getWriterid().getLastname() }}</h5>
                            <div class="row g-0" style="height:150px">
                                <div class="ps-3 col-md-3">
                                    <img src="../../image/black.jpg" class="rounded-start" alt="book">
                                </div>
                                <div class="col-md-9 my-3">
                                    <p class="card-text">{{book.getPlot()}}</p>
                                </div>
                            </div>
                            <div class="text-end border-top">Nombre d'exemplaire(s) disponible(s) {{ book.getStock() }}/{{ book.getQuantity() }}</div>
                        </td>
                        <td>
                            <div class='d-flex flex-column justify-content-between align-items-center'>
                                <a class="btn btn-success mb-2" href="{{ path('book_infos', {'id': book.getId()} )}}">Plus d'infos</a>
                                {% if book.getStock() != 0 %}
                                <a class="btn btn-danger mt-2" href="{{ path('book_delete', {'id': book.getId()} )}}">Supprimer</a>
                                {% endif %}
                            </div> 
                        </td>   
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</main>
{% endblock %}
